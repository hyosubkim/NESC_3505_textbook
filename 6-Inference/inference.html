
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Statistical inference &#8212; Data Science for Kinesiology</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/NESC3505_icon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Introduction to Single Unit Data" href="../7-single_unit/introduction.html" />
    <link rel="prev" title="Basic Statistics in Python: t tests with SciPy" href="../5-eda/ttests.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/NESC3505_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Data Science for Kinesiology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Acknowledgments
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  1. About This Course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1-intro/about-this-course.html">
   About this course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1-intro/learning_objectives.html">
   Learning Objectives for this Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1-intro/academic-integrity.html">
   Academic Integrity and Collaboration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  2. Introduction to Data Science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../2-nds/introduction.html">
   Getting Started with the Course
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2-nds/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2-nds/what-is-datascience.html">
   What is Data Science?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/data.html">
     Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2-nds/tools_for_datasci.html">
   Tools for (Kinesiological) Data Science
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/spreadsheets.html">
     Spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/spreadsheets_limits.html">
     Limitations of Spreadsheets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/reproducibility.html">
     Reproducibility
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/sci_prog_lang.html">
     Scientific Programming Languages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/which_lang.html">
     Which language to use?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/libs.html">
     Libraries and packages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/why_python.html">
     Why Python for this Course?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2-nds/coding.html">
   Coding Tools
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/python.html">
     Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/datacamp.html">
     DataCamp
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/jupyter.html">
     Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2-nds/markdown.html">
     Markdown
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  3. Introduction to Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../3-python/introduction.html">
   Introducing Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-python/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-python/jupyter_jhub.html">
   Introduction to Jupyter Notebooks in JupyterHub
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-python/getting_help.html">
   Getting Help with Python
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3-python/data_types.html">
   Data types
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/variables_assignment.html">
     Variables and Assignment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/types_conversion.html">
     Data Types and Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/builtin.html">
     Python Built-Ins
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/lists.html">
     Lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/dictionaries.html">
     Dictionaries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3-python/flow_control.html">
   Flow Control
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/for_loops.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       for
      </span>
     </code>
     Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/conditionals.html">
     Conditionals
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-python/writing-a-function.html">
   Writing Functions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3-python/working_w_data.html">
   Working with Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/pandas_dataframes.html">
     Introduction to pandas DataFrames
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3-python/looping_data_files.html">
     Looping Over Data Files
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  4. Data Visualization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/introduction.html">
   Introduction to Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/plotting.html">
   Introduction to Plotting with Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/proc_vs_oo.html">
   Procedural versus Object-Oriented Plotting in Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/subplots.html">
   Subplots
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/plotting_types.html">
   Thinking About Data for Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/seaborn.html">
   Introduction to Plotting with Seaborn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-viz/human_factors.html">
   Accessibility and Human Factors in Plotting
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  5. Exploratory Data Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../5-eda/introduction.html">
   Introduction to EDA
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-eda/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-eda/repeated_measures.html">
   Working with Repeated Measures Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-eda/data_cleaning.html">
   Data Cleaning - Dealing with Outliers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-eda/ttests.html">
   Basic Statistics in Python:
   <em>
    t
   </em>
   tests with SciPy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  6. Statistical Inference and the Bootstrap
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Statistical inference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  7. Single Unit Data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../7-single_unit/introduction.html">
   Introduction to Single Unit Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../7-single_unit/learning_objectives.html">
   Learning Objectives
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7-single_unit/single_unit_intro.html">
   Single Unit Data and Spike Trains
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7-single_unit/intro_spike_trains.html">
     Introduction to Spike Train Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7-single_unit/ten_intensities.html">
     Effects of Light Intensity on Spike Rate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7-single_unit/heat_maps.html">
     Heat Maps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7-single_unit/intro_multielec_data.html">
   Introducing Multielectrode Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7-single_unit/pandas_multielec.html">
     Working with Multielectrode Data in pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7-single_unit/corr_spike_trains.html">
     Correlating spike trains
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  8. Signal Processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../8-signal_processing/signals-sampling-filtering.html">
   Signals, Sampling &amp; Filtering
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/hyosubkim/datasci-for-kin/master?urlpath=tree/6-Inference/inference.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/hyosubkim/datasci-for-kin"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/hyosubkim/datasci-for-kin/issues/new?title=Issue%20on%20page%20%2F6-Inference/inference.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/6-Inference/inference.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-learning-objectives">
   Chapter learning objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-do-we-need-sampling">
   Why do we need sampling?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling-distributions">
   Sampling distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distributions-for-proportions">
     Sampling distributions for proportions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distributions-for-means">
     Sampling distributions for means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bootstrapping">
   Bootstrapping
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Overview
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bootstrapping-in-python">
     Bootstrapping in Python
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-the-bootstrap-to-calculate-a-plausible-range">
     Using the bootstrap to calculate a plausible range
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional resources
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Statistical inference</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-learning-objectives">
   Chapter learning objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-do-we-need-sampling">
   Why do we need sampling?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling-distributions">
   Sampling distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distributions-for-proportions">
     Sampling distributions for proportions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-distributions-for-means">
     Sampling distributions for means
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#summary">
     Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bootstrapping">
   Bootstrapping
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Overview
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bootstrapping-in-python">
     Bootstrapping in Python
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-the-bootstrap-to-calculate-a-plausible-range">
     Using the bootstrap to calculate a plausible range
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional resources
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="statistical-inference">
<h1>Statistical inference<a class="headerlink" href="#statistical-inference" title="Permalink to this headline">#</a></h1>
<p><em>This chapter has been adapted from <a class="reference external" href="https://python.datasciencebook.ca/inference.html">Data Science: A First Introduction (Python Edition)</a>, by Trevor Campbell, Tiffany Timbers, Melissa Lee, Lindsey Heagy, and Joel Ostblom of UBC.</em></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">#</a></h2>
<p>A typical data analysis task in practice is to draw conclusions about some
unknown aspect of a population of interest based on observed data sampled from
that population; we typically do not get data on the <em>entire</em> population.  Data
analysis questions regarding how summaries, patterns, trends, or relationships
in a data set extend to the wider population are called <em>inferential
questions</em>. This chapter will start with the fundamental ideas of sampling from
populations and then introduce two common techniques in statistical inference:
<em>point estimation</em> and <em>interval estimation</em>.</p>
</section>
<section id="chapter-learning-objectives">
<h2>Chapter learning objectives<a class="headerlink" href="#chapter-learning-objectives" title="Permalink to this headline">#</a></h2>
<p>By the end of the chapter, readers will be able to do the following:</p>
<ul class="simple">
<li><p>Describe real-world examples of questions that can be answered with statistical inference.</p></li>
<li><p>Define common population parameters (e.g., mean, proportion, standard deviation) that are often estimated using sampled data, and estimate these from a sample.</p></li>
<li><p>Define the following statistical sampling terms (population, sample, population parameter, point estimate, sampling distribution).</p></li>
<li><p>Explain the difference between a population parameter and a sample point estimate.</p></li>
<li><p>Use Python to draw random samples from a finite population.</p></li>
<li><p>Use Python to create a sampling distribution from a finite population.</p></li>
<li><p>Describe how sample size influences the sampling distribution.</p></li>
<li><p>Define bootstrapping.</p></li>
<li><p>Use Python to create a bootstrap distribution to approximate a sampling distribution.</p></li>
<li><p>Contrast the bootstrap and sampling distributions.</p></li>
</ul>
</section>
<section id="why-do-we-need-sampling">
<h2>Why do we need sampling?<a class="headerlink" href="#why-do-we-need-sampling" title="Permalink to this headline">#</a></h2>
<p>We often need to understand how quantities we observe in a subset
of data relate to the same quantities in the broader population. For example, suppose a
retailer is considering selling iPhone accessories, and they want to estimate
how big the market might be. Additionally, they want to strategize how they can
market their products on North American college and university campuses. This
retailer might formulate the following question:</p>
<p><em>What proportion of all undergraduate students in North America own an iPhone?</em></p>
<p>In the above question, we are interested in making a conclusion about <em>all</em>
undergraduate students in North America; this is referred to as the <strong>population</strong>. In
general, the population is the complete collection of individuals or cases we
are interested in studying.  Further, in the above question, we are interested
in computing a quantity—the proportion of iPhone owners—based on
the entire population. This proportion is referred to as a <strong>population parameter</strong>. In
general, a population parameter is a numerical characteristic of the entire
population. To compute this number in the example above, we would need to ask
every single undergraduate in North America whether they own an iPhone. In
practice, directly computing population parameters is often time-consuming and
costly, and sometimes impossible.</p>
<p>A more practical approach would be to make measurements from a <strong>sample</strong>, i.e., a
subset of individuals collected from the population. We can then compute a
<strong>sample estimate</strong>—a numerical characteristic of the sample—that
estimates the population parameter. For example, suppose we randomly selected
ten undergraduate students across North America (the sample) and computed the
proportion of those students who own an iPhone (the sample estimate). In that
case, we might suspect that proportion is a reasonable estimate of the
proportion of students who own an iPhone in the entire population.
The figure below illustrates this process.
In general, the process of using a sample to make a conclusion about the
broader population from which it is taken is referred to as <strong>statistical inference</strong>.</p>
<p><img alt="" src="../_images/population_vs_sample.png" /></p>
<p>Note that proportions are not the <em>only</em> kind of population parameter we might
be interested in. For example, suppose an undergraduate student studying at the University
of British Columbia in Canada is looking for an apartment
to rent. They need to create a budget, so they want to know something about
studio apartment rental prices in Vancouver, BC. This student might
formulate the following question:</p>
<p><em>What is the average price-per-month of studio apartment rentals in Vancouver, Canada?</em></p>
<p>In this case, the population consists of all studio apartment rentals in Vancouver, and the
population parameter is the <em>average price-per-month</em>. Here we used the average
as a measure of the center to describe the “typical value” of studio apartment
rental prices. But even within this one example, we could also be interested in
many other population parameters. For instance, we know that not every studio
apartment rental in Vancouver will have the same price per month. The student
might be interested in how much monthly prices vary and want to find a measure
of the rentals’ spread (or variability), such as the standard deviation. Or perhaps the
student might be interested in the fraction of studio apartment rentals that
cost more than $1000 per month. The question we want to answer will help us
determine the parameter we want to estimate. If we were somehow able to observe
the whole population of studio apartment rental offerings in Vancouver, we
could compute each of these numbers exactly; therefore, these are all
population parameters. There are many kinds of observations and population
parameters that you will run into in practice, but in this chapter, we will
focus on two settings:</p>
<ol class="simple">
<li><p>Using categorical observations to estimate the proportion of a category</p></li>
<li><p>Using quantitative observations to estimate the average (or mean)</p></li>
</ol>
</section>
<section id="sampling-distributions">
<h2>Sampling distributions<a class="headerlink" href="#sampling-distributions" title="Permalink to this headline">#</a></h2>
<section id="sampling-distributions-for-proportions">
<h3>Sampling distributions for proportions<a class="headerlink" href="#sampling-distributions-for-proportions" title="Permalink to this headline">#</a></h3>
<p>We will look at an example using data from
<a class="reference external" href="http://insideairbnb.com/">Inside Airbnb</a>. Airbnb is an online
marketplace for arranging vacation rentals and places to stay. The data set
contains listings for Vancouver, Canada, in September 2020. Our data
includes an ID number, neighborhood, type of room, the number of people the
rental accommodates, number of bathrooms, bedrooms, beds, and the price per
night.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start off with standard imports</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in data</span>
<span class="n">airbnb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/listings.csv&quot;</span><span class="p">)</span>
<span class="n">airbnb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>neighbourhood</th>
      <th>room_type</th>
      <th>accommodates</th>
      <th>bathrooms</th>
      <th>bedrooms</th>
      <th>beds</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>5</td>
      <td>2 baths</td>
      <td>2</td>
      <td>2</td>
      <td>150.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Downtown Eastside</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>2 baths</td>
      <td>2</td>
      <td>2</td>
      <td>132.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>West End</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>85.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Kensington-Cedar Cottage</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>0</td>
      <td>146.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Kensington-Cedar Cottage</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>110.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4589</th>
      <td>4590</td>
      <td>Downtown Eastside</td>
      <td>Entire home/apt</td>
      <td>5</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>99.00</td>
    </tr>
    <tr>
      <th>4590</th>
      <td>4591</td>
      <td>Oakridge</td>
      <td>Private room</td>
      <td>2</td>
      <td>1.5 baths</td>
      <td>1</td>
      <td>1</td>
      <td>42.51</td>
    </tr>
    <tr>
      <th>4591</th>
      <td>4592</td>
      <td>Dunbar Southlands</td>
      <td>Private room</td>
      <td>2</td>
      <td>1.5 shared baths</td>
      <td>1</td>
      <td>1</td>
      <td>53.29</td>
    </tr>
    <tr>
      <th>4592</th>
      <td>4593</td>
      <td>West End</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>145.00</td>
    </tr>
    <tr>
      <th>4593</th>
      <td>4594</td>
      <td>Shaughnessy</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>1 bath</td>
      <td>3</td>
      <td>4</td>
      <td>135.00</td>
    </tr>
  </tbody>
</table>
<p>4594 rows × 8 columns</p>
</div></div></div>
</div>
<p>Suppose the city of Vancouver wants information about Airbnb rentals to help
plan city bylaws, and they want to know how many Airbnb places are listed as
entire homes and apartments (rather than as private or shared rooms). Therefore
they may want to estimate the true proportion of all Airbnb listings where the
room type is listed as “entire home or apartment.” Of course, we usually
do not have access to the true population, but here let’s imagine (for learning
purposes) that our data set represents the population of all Airbnb rental
listings in Vancouver, Canada.
We can find the proportion of listings for each room type
by using the <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> function with the <code class="docutils literal notranslate"><span class="pre">normalize</span></code> parameter. <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> returns a Series object containing counts of unique values, and <code class="docutils literal notranslate"><span class="pre">normalize</span></code>, if set to True,  will normalize these counts and convert them to proportions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airbnb</span><span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entire home/apt    0.747497
Private room       0.246408
Shared room        0.005224
Hotel room         0.000871
Name: room_type, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can see that the proportion of <code class="docutils literal notranslate"><span class="pre">Entire</span> <span class="pre">home/apt</span></code> listings in
the data set is 0.747. This
value, 0.747, is the population parameter. <strong>Remember, this
parameter value is usually unknown in real data analysis problems, <em>as it is
typically not possible to make measurements for an entire population.</em></strong></p>
<p>Instead, perhaps we can approximate it with a small subset of data!
To investigate this idea, let’s try randomly selecting 40 listings (<em>i.e.,</em> taking a random sample of
size 40 from our population), and computing the proportion for that sample.
We will use the <code class="docutils literal notranslate"><span class="pre">sample</span></code> method of the <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>
object to take the sample. The argument <code class="docutils literal notranslate"><span class="pre">n</span></code> of <code class="docutils literal notranslate"><span class="pre">sample</span></code> is the size of the sample to take
and since we are starting to use randomness here,
we are also setting the random seed via numpy to make the results reproducible. Setting the seed means that our program’s random number generator will output the same sequence of “random” numbers each time we run this program. (You can Google “why random number generators aren’t random” if you’re interested in this apparent paradox).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set seed for reproducible results</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">155</span><span class="p">)</span>
<span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entire home/apt    0.725
Private room       0.250
Shared room        0.025
Name: room_type, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Here we see that the proportion of entire home/apartment listings in this
random sample is 0.725. Wow—that’s close to our
true population value! But remember, we computed the proportion using a random sample of size 40.
This has two consequences. First, this value is only an <em>estimate</em>, i.e., our best guess
of our population parameter using this sample.
Given that we are estimating a single value here, we often
refer to it as a <strong>point estimate</strong>.  Second, since the sample was random,
if we were to take <em>another</em> random sample of size 40 and compute the proportion for that sample,
we would not get the same answer:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">40</span><span class="p">)[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Entire home/apt    0.625
Private room       0.350
Shared room        0.025
Name: room_type, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Confirmed! We get a different value for our estimate this time.
That means that our point estimate might be unreliable. Indeed, estimates vary from sample to
sample due to <strong>sampling variability</strong>. But just how much
should we expect the estimates of our random samples to vary?
Or in other words, how much can we really trust our point estimate based on a single sample?</p>
<p>To understand this, we will simulate many samples (much more than just two)
of size 40 from our population of listings and calculate the proportion of
entire home/apartment listings in each sample. This simulation will create
many sample proportions, which we can visualize using a histogram. The
distribution of the estimate for all possible samples of a given size (which we
commonly refer to as <span class="math notranslate nohighlight">\(n\)</span>) from a population is called
a <strong>sampling distribution</strong>. The sampling distribution will help us see how much we would
expect our sample proportions from this population to vary for samples of size 40.</p>
<p>We again use the <code class="docutils literal notranslate"><span class="pre">sample</span></code> to take samples of size 40 from our
population of Airbnb listings. But this time we use a list comprehension
to repeat an operation multiple time (as in previous chapters).
In this case we are taking 20,000 samples of size 40
and to make it clear which rows in the data frame come
which of the 20,000 samples,
we also add (“assign”) a column called <code class="docutils literal notranslate"><span class="pre">replicate</span></code> with this information.
The call to <code class="docutils literal notranslate"><span class="pre">concat</span></code> concatenates all the 20,000 data frames
returned from the list comprehension into a single big data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use list comprehension </span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">replicate</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20000</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">samples</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>neighbourhood</th>
      <th>room_type</th>
      <th>accommodates</th>
      <th>bathrooms</th>
      <th>bedrooms</th>
      <th>beds</th>
      <th>price</th>
      <th>replicate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>605</th>
      <td>606</td>
      <td>Marpole</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>91.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4579</th>
      <td>4580</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>160.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1739</th>
      <td>1740</td>
      <td>West End</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>151.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3904</th>
      <td>3905</td>
      <td>Oakridge</td>
      <td>Private room</td>
      <td>6</td>
      <td>1 private bath</td>
      <td>3</td>
      <td>3</td>
      <td>185.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1596</th>
      <td>1597</td>
      <td>Kitsilano</td>
      <td>Entire home/apt</td>
      <td>1</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>99.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3060</th>
      <td>3061</td>
      <td>Hastings-Sunrise</td>
      <td>Private room</td>
      <td>2</td>
      <td>3.5 shared baths</td>
      <td>1</td>
      <td>1</td>
      <td>78.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>527</th>
      <td>528</td>
      <td>Kitsilano</td>
      <td>Private room</td>
      <td>4</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>99.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>1587</th>
      <td>1588</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>1 bath</td>
      <td>1</td>
      <td>3</td>
      <td>169.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>3860</th>
      <td>3861</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>100.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>2747</th>
      <td>2748</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>285.0</td>
      <td>19999</td>
    </tr>
  </tbody>
</table>
<p>800000 rows × 9 columns</p>
</div></div></div>
</div>
<p>Since the column <code class="docutils literal notranslate"><span class="pre">replicate</span></code> indicates the replicate/sample number,
we can verify that we indeed seem to have 20,0000 samples
starting at sample 0 and ending at sample 19,999.</p>
<p>Now that we have obtained the samples, we need to compute the
proportion of entire home/apartment listings in each sample.
We first <code class="docutils literal notranslate"><span class="pre">query</span></code> the observations with room type of “Entire home/apt”;
group the data by the <code class="docutils literal notranslate"><span class="pre">replicate</span></code> variable—to group the
set of listings in each sample together—and then use <code class="docutils literal notranslate"><span class="pre">count</span></code>
to compute the number of qualified observations in each sample; finally compute the proportion.
Both the first and last few entries of the resulting data frame are printed
below to show that we end up with 20,000 point estimates, one for each of the 20,000 samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;replicate&quot;</span><span class="p">)[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>replicate  room_type      
0          Entire home/apt    0.750
           Private room       0.250
1          Entire home/apt    0.775
           Private room       0.225
2          Entire home/apt    0.750
                              ...  
19998      Entire home/apt    0.700
           Private room       0.275
           Shared room        0.025
19999      Entire home/apt    0.750
           Private room       0.250
Name: room_type, Length: 44552, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The returned object is a series,
and as we have previously learned
we can use <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> to change it to a data frame.
However,
there is one caveat here:
when we use the <code class="docutils literal notranslate"><span class="pre">value_counts</span></code> function
on a grouped series and try to <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>
we will end up with two columns with the same name
and therefore get an error
(in this case, <code class="docutils literal notranslate"><span class="pre">room_type</span></code> will occur twice).
Fortunately,
there is a simple solution:
when we call <code class="docutils literal notranslate"><span class="pre">reset_index</span></code>,
we can specify the name of the new column
with the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;replicate&quot;</span><span class="p">)[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sample_proportion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>replicate</th>
      <th>room_type</th>
      <th>sample_proportion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Private room</td>
      <td>0.250</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Entire home/apt</td>
      <td>0.775</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Private room</td>
      <td>0.225</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>44547</th>
      <td>19998</td>
      <td>Entire home/apt</td>
      <td>0.700</td>
    </tr>
    <tr>
      <th>44548</th>
      <td>19998</td>
      <td>Private room</td>
      <td>0.275</td>
    </tr>
    <tr>
      <th>44549</th>
      <td>19998</td>
      <td>Shared room</td>
      <td>0.025</td>
    </tr>
    <tr>
      <th>44550</th>
      <td>19999</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>44551</th>
      <td>19999</td>
      <td>Private room</td>
      <td>0.250</td>
    </tr>
  </tbody>
</table>
<p>44552 rows × 3 columns</p>
</div></div></div>
</div>
<p>Below we put everything together
and also filter the data frame to keep only the room types
that we are interested in.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_estimates</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">samples</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;replicate&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sample_proportion&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">sample_estimates</span> <span class="o">=</span> <span class="n">sample_estimates</span><span class="p">[</span><span class="n">sample_estimates</span><span class="p">[</span><span class="s2">&quot;room_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Entire home/apt&quot;</span><span class="p">]</span>
<span class="n">sample_estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>replicate</th>
      <th>room_type</th>
      <th>sample_proportion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Entire home/apt</td>
      <td>0.775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3</td>
      <td>Entire home/apt</td>
      <td>0.675</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>Entire home/apt</td>
      <td>0.725</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>44541</th>
      <td>19995</td>
      <td>Entire home/apt</td>
      <td>0.775</td>
    </tr>
    <tr>
      <th>44543</th>
      <td>19996</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
    <tr>
      <th>44545</th>
      <td>19997</td>
      <td>Entire home/apt</td>
      <td>0.725</td>
    </tr>
    <tr>
      <th>44547</th>
      <td>19998</td>
      <td>Entire home/apt</td>
      <td>0.700</td>
    </tr>
    <tr>
      <th>44550</th>
      <td>19999</td>
      <td>Entire home/apt</td>
      <td>0.750</td>
    </tr>
  </tbody>
</table>
<p>20000 rows × 3 columns</p>
</div></div></div>
</div>
<p>We can now visualize the sampling distribution of sample proportions
for samples of size 40 using a histogram. Keep in mind: in the real world,
we don’t have access to the full population. So we
can’t take many samples and can’t actually construct or visualize the sampling distribution.
We have created this particular example
such that we <em>do</em> have access to the full population, which lets us visualize the
sampling distribution directly for learning purposes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sample_estimates</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;sample_proportion&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sample proportions&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Sampling distribution of the sample proportion for sample size 40&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_22_0.png" src="../_images/inference_22_0.png" />
</div>
</div>
<p>The sampling distribution above appears
to be bell-shaped, is roughly symmetric, and has one peak. It is centered
around 0.75 and the sample proportions
range from about 0.55 to about
0.95. In fact, we can
calculate the mean of the sample proportions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_estimates</span><span class="p">[</span><span class="s2">&quot;sample_proportion&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.74848375
</pre></div>
</div>
</div>
</div>
<p>We notice that the sample proportions are centered around the population
proportion value,0.748! In general, the mean of
the sampling distribution should be equal to the population proportion.
This is great news because it means that the sample proportion is neither an overestimate nor an
underestimate of the population proportion.
In other words, if you were to take many samples as we did above, there is no tendency
towards over or underestimating the population proportion.
In a real data analysis setting where you just have access to your single
sample, this implies that you would suspect that your sample point estimate is
roughly equally likely to be above or below the true population proportion.</p>
</section>
<section id="sampling-distributions-for-means">
<h3>Sampling distributions for means<a class="headerlink" href="#sampling-distributions-for-means" title="Permalink to this headline">#</a></h3>
<p>In the previous section, our variable of interest—<code class="docutils literal notranslate"><span class="pre">room_type</span></code>—was
<em>categorical</em>, and the population parameter was a proportion. As mentioned in
the chapter introduction, there are many choices of the population parameter
for each type of variable. What if we wanted to infer something about a
population of <em>quantitative</em> variables instead? For instance, a traveler
visiting Vancouver, Canada may wish to estimate the
population <em>mean</em> (or average) price per night of Airbnb listings. Knowing
the average could help them tell whether a particular listing is overpriced.
We can visualize the population distribution of the price per night with a histogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">airbnb</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1050</span><span class="p">,</span> <span class="mi">22</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Price per night (dollars)&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Population distribution of price per night&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_27_0.png" src="../_images/inference_27_0.png" />
</div>
</div>
<p>In this figure, we see that the population distribution
has one peak. It is also skewed (i.e., is not symmetric): most of the listings are
less than $250 per night, but a small number of listings cost much more,
creating a long tail on the histogram’s right side.
Along with visualizing the population, we can calculate the population mean,
the average price per night for all the Airbnb listings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">airbnb</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>154.5109773617762
</pre></div>
</div>
</div>
</div>
<p>The price per night of all Airbnb rentals in Vancouver, BC
is $154.51, on average. This value is our
population parameter since we are calculating it using the population data.</p>
<p>Now suppose we did not have access to the population data (which is nearly <em>always</em> the
case!), yet we wanted to estimate the mean price per night. We could answer
this question by taking a random sample of as many Airbnb listings as our time
and resources allow. Let’s say we could do this for 40 listings. What would
such a sample look like?  Let’s take advantage of the fact that we do have
access to the population data and simulate taking one random sample of 40
listings in Python, again using <code class="docutils literal notranslate"><span class="pre">sample</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_sample</span> <span class="o">=</span> <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can create a histogram to visualize the distribution of observations in the
sample, and calculate the mean
of our sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">one_sample</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_33_0.png" src="../_images/inference_33_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_sample</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>153.48225
</pre></div>
</div>
</div>
</div>
<p>The average value of the sample of size 40
is \<span class="math notranslate nohighlight">\(152.48. This
number is a point estimate for the mean of the full population.
Recall that the population mean was
\\\)</span>154.51. So our estimate was fairly close to
the population parameter: the mean was about
0.7%
off.  Note that we usually cannot compute the estimate’s accuracy in practice
since we do not have access to the population parameter; if we did, we wouldn’t
need to estimate it!</p>
<p>Also, recall from the previous section that the point estimate can vary; if we
took another random sample from the population, our estimate’s value might
change. So then, did we just get lucky with our point estimate above?  How much
does our estimate vary across different samples of size 40 in this example?
Again, since we have access to the population, we can take many samples and
plot the sampling distribution of sample means to get a sense for this variation.
In this case, we’ll use the 20,000 samples of size
40 that we already stored in the <code class="docutils literal notranslate"><span class="pre">samples</span></code> variable.
First we will calculate the sample mean for each replicate
and then plot the sampling
distribution of sample means for samples of size 40.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_estimates</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">samples</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;replicate&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_price&quot;</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">sample_estimates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>replicate</th>
      <th>mean_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>187.00000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>148.56075</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>165.50500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>140.93925</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>139.14650</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19995</th>
      <td>19995</td>
      <td>198.50000</td>
    </tr>
    <tr>
      <th>19996</th>
      <td>19996</td>
      <td>192.66425</td>
    </tr>
    <tr>
      <th>19997</th>
      <td>19997</td>
      <td>144.88600</td>
    </tr>
    <tr>
      <th>19998</th>
      <td>19998</td>
      <td>146.08800</td>
    </tr>
    <tr>
      <th>19999</th>
      <td>19999</td>
      <td>156.25000</td>
    </tr>
  </tbody>
</table>
<p>20000 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sample_estimates</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;mean_price&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sample mean price per night (dollars)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_37_0.png" src="../_images/inference_37_0.png" />
</div>
</div>
<p>In the figure above, the sampling distribution of the mean
has one peak and is bell-shaped. Most of the estimates are between
about  \<span class="math notranslate nohighlight">\(140 and
\\\)</span>160; but there are
a good fraction of cases outside this range (i.e., where the point estimate was
not close to the population parameter). So it does indeed look like we were
quite lucky when we estimated the population mean with only
0.7% error.</p>
<p>Let’s visualize the population distribution, distribution of the sample, and
the sampling distribution on one plot to compare them. Comparing these three distributions, the centers
of the distributions are all around the same price (around $150). The original
population distribution has a long right tail, and the sample distribution has
a similar shape to that of the population distribution. However, the sampling
distribution is not shaped like the population or sample distribution. Instead,
it has a bell shape, and it has a lower spread than the population or sample
distributions. The sample means vary less than the individual observations
because there will be some high values and some small values in any random
sample, which will keep the average from being too extreme.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up mutli-panel figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Population distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">airbnb</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">661</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price per night (dollars)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="c1"># Sample distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">one_sample</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">661</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sample (n = 40)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price per night (dollars)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="c1"># Sampling distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample_estimates</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">661</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sampling distribution of the mean (samples of size 40)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price per night (dollars)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Comparison of population distribution, sample distribution, and sampling distribution&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_39_0.png" src="../_images/inference_39_0.png" />
</div>
</div>
<p>Given that there is quite a bit of variation in the sampling distribution of
the sample mean—i.e., the point estimate that we obtain is not very
reliable—is there any way to improve the estimate?  One way to improve a
point estimate is to take a <em>larger</em> sample. To illustrate what effect this
has, we will take many samples of size 20, 50, 100, and 500, and plot the
sampling distribution of the sample mean. We indicate the mean of the sampling
distribution with a orange vertical line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot sampling distributions for multiple sample sizes</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">replicates</span> <span class="o">=</span> <span class="mi">20000</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
        <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="n">replicate</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">sample_sizes</span>
    <span class="p">])</span>
    <span class="k">for</span> <span class="n">replicate</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">replicates</span><span class="p">)</span>
<span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;sample_size&quot;</span><span class="p">,</span> <span class="s2">&quot;replicate&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/indexes/base.py:3803,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">3802</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3803</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">casted_key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3804</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/_libs/index.pyx:138,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/_libs/index.pyx:165,</span> in <span class="ni">pandas._libs.index.IndexEngine.get_loc</span><span class="nt">()</span>

<span class="nn">File pandas/_libs/hashtable_class_helper.pxi:5745,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="nn">File pandas/_libs/hashtable_class_helper.pxi:5753,</span> in <span class="ni">pandas._libs.hashtable.PyObjectHashTable.get_item</span><span class="nt">()</span>

<span class="ne">KeyError</span>: &#39;replicate&#39;

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/frame.py:4138,</span> in <span class="ni">DataFrame._set_item_mgr</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">4137</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4138</span>     <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4139</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4140</span>     <span class="c1"># This item wasn&#39;t present, just insert at end</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/indexes/base.py:3805,</span> in <span class="ni">Index.get_loc</span><span class="nt">(self, key, method, tolerance)</span>
<span class="g g-Whitespace">   </span><span class="mi">3804</span> <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3805</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">   </span><span class="mi">3806</span> <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3807</span>     <span class="c1"># If we have a listlike key, _check_indexing_error will raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3808</span>     <span class="c1">#  InvalidIndexError. Otherwise we fall through and re-raise</span>
<span class="g g-Whitespace">   </span><span class="mi">3809</span>     <span class="c1">#  the TypeError.</span>

<span class="ne">KeyError</span>: &#39;replicate&#39;

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">replicates</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">base</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="n">replicate</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>         <span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">sample_sizes</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="p">])</span>
<span class="nn">     10     for replicate</span> in <span class="ni">range</span><span class="nt">(replicates)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;sample_size&quot;</span><span class="p">,</span> <span class="s2">&quot;replicate&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nn">Cell In[20], line 6,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">replicates</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">base</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
<span class="ne">----&gt; </span><span class="mi">6</span>     <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>         <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="n">replicate</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>         <span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">sample_sizes</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="p">])</span>
<span class="nn">     10     for replicate</span> in <span class="ni">range</span><span class="nt">(replicates)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;sample_size&quot;</span><span class="p">,</span> <span class="s2">&quot;replicate&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nn">Cell In[20], line 7,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">replicates</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">base</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
<span class="ne">----&gt; </span><span class="mi">7</span>         <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">sample_size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">replicate</span><span class="o">=</span><span class="n">replicate</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>         <span class="k">for</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="n">sample_sizes</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="p">])</span>
<span class="nn">     10     for replicate</span> in <span class="ni">range</span><span class="nt">(replicates)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;sample_size&quot;</span><span class="p">,</span> <span class="s2">&quot;replicate&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/frame.py:4878,</span> in <span class="ni">DataFrame.assign</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">4875</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">4877</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="ne">-&gt; </span><span class="mi">4878</span>     <span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="n">apply_if_callable</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4879</span> <span class="k">return</span> <span class="n">data</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/frame.py:3977,</span> in <span class="ni">DataFrame.__setitem__</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">3974</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_array</span><span class="p">([</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3975</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3976</span>     <span class="c1"># set column</span>
<span class="ne">-&gt; </span><span class="mi">3977</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_set_item</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/frame.py:4184,</span> in <span class="ni">DataFrame._set_item</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">4181</span>         <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">existing_piece</span><span class="p">,</span> <span class="n">DataFrame</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">4182</span>             <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">existing_piece</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="ne">-&gt; </span><span class="mi">4184</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_item_mgr</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/frame.py:4141,</span> in <span class="ni">DataFrame._set_item_mgr</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">4138</span>     <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4139</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4140</span>     <span class="c1"># This item wasn&#39;t present, just insert at end</span>
<span class="ne">-&gt; </span><span class="mi">4141</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="p">),</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4142</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4143</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_iset_item_mgr</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/internals/managers.py:1403,</span> in <span class="ni">BlockManager.insert</span><span class="nt">(self, loc, item, value)</span>
<span class="g g-Whitespace">   </span><span class="mi">1401</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1402</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_insert_update_mgr_locs</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1403</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_insert_update_blklocs_and_blknos</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1405</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_axis</span>
<span class="g g-Whitespace">   </span><span class="mi">1406</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">+=</span> <span class="p">(</span><span class="n">block</span><span class="p">,)</span>

<span class="nn">File ~/opt/anaconda3/envs/datasci-for-kin/lib/python3.10/site-packages/pandas/core/internals/managers.py:1442,</span> in <span class="ni">BlockManager._insert_update_blklocs_and_blknos</span><span class="nt">(self, loc)</span>
<span class="g g-Whitespace">   </span><span class="mi">1439</span> <span class="c1"># Accessing public blklocs ensures the public versions are initialized</span>
<span class="g g-Whitespace">   </span><span class="mi">1440</span> <span class="k">if</span> <span class="n">loc</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">blklocs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<span class="g g-Whitespace">   </span><span class="mi">1441</span>     <span class="c1"># np.append is a lot faster, let&#39;s use it if we can.</span>
<span class="ne">-&gt; </span><span class="mi">1442</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_blklocs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blklocs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1443</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_blknos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_blknos</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1444</span> <span class="k">elif</span> <span class="n">loc</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1445</span>     <span class="c1"># np.append is a lot faster, let&#39;s use it if we can.</span>

<span class="nn">File &lt;__array_function__ internals&gt;:177,</span> in <span class="ni">append</span><span class="nt">(*args, **kwargs)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up subplots </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">})</span>

<span class="c1"># Iterate through sample sizes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample_size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">]):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Plot histogram</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;sample_size&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">sample_size</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">],</span>
                 <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Plot mean line</span>
    <span class="n">mean_price</span> <span class="o">=</span> <span class="n">base</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">base</span><span class="p">[</span><span class="s1">&#39;sample_size&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">sample_size</span><span class="p">,</span> <span class="s1">&#39;price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean_price</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f58518&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Annotate mean value</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mean_price</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Mean = </span><span class="si">{</span><span class="n">mean_price</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f58518&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># Set axis labels and title</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2800</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sample Size = </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Set common x-axis label</span>
<span class="n">axs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sample mean price per night (dollars)&quot;</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_42_0.png" src="../_images/inference_42_0.png" />
</div>
</div>
<p>Based on the visualization above, three points
about the sample mean become clear:</p>
<ol class="simple">
<li><p>The mean of the sample mean (across
samples) is equal to the population mean. In other words, the sampling
distribution is centered at the population mean.</p></li>
<li><p>Increasing the size of
the sample decreases the spread (i.e., the variability) of the sampling
distribution. Therefore, a larger sample size results in a more reliable point
estimate of the population parameter.</p></li>
<li><p>The distribution of the sample mean is roughly bell-shaped.</p></li>
</ol>
<div class="alert alert-block alert-info">
    <b>Note:</b> You might notice that in the <b>n = 20</b> case in this figure,
    the distribution is not <i>quite</i> bell-shaped. There is a bit of skew towards the right!
    You might also notice that in the <b>n = 50</b> case and larger, that skew seems to disappear.
In general, the sampling distribution&mdash;for both means and proportions&mdash;only
    becomes bell-shaped <i>once the sample size is large enough</i>.
How large is "large enough?" Unfortunately, it depends entirely on the problem at hand. But
as a rule of thumb, often a sample size of at least 20 will suffice.
                            </div></section>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h3>
<ol class="simple">
<li><p>A point estimate is a single value computed using a sample from a population (e.g., a mean or proportion).</p></li>
<li><p>The sampling distribution of an estimate is the distribution of the estimate for all possible samples of a fixed size from the same population.</p></li>
<li><p>The shape of the sampling distribution is usually bell-shaped with one peak and centered at the population mean or proportion.</p></li>
<li><p>The spread of the sampling distribution is related to the sample size. As the sample size increases, the spread of the sampling distribution decreases.</p></li>
</ol>
</section>
</section>
<section id="bootstrapping">
<h2>Bootstrapping<a class="headerlink" href="#bootstrapping" title="Permalink to this headline">#</a></h2>
<section id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p><em>Why all this emphasis on sampling distributions?</em></p>
<p>We saw in the previous section that we could compute a <strong>point estimate</strong> of a
population parameter using a sample of observations from the population. And
since we constructed examples where we had access to the population, we could
evaluate how accurate the estimate was, and even get a sense of how much the
estimate would vary for different samples from the population.  But in real
data analysis settings, we usually have <em>just one sample</em> from our population
and do not have access to the population itself. Therefore we cannot construct
the sampling distribution as we did in the previous section. And as we saw, our
sample estimate’s value can vary significantly from the population parameter.
So reporting the point estimate from a single sample alone may not be enough.
<em>We also need to report some notion of <em>uncertainty</em> in the value of the point
estimate.</em></p>
<p>Unfortunately, we cannot construct the exact sampling distribution without
full access to the population. However, if we could somehow <em>approximate</em> what
the sampling distribution would look like for a sample, we could
use that approximation to then report how uncertain our sample
point estimate is (as we did above with the <em>exact</em> sampling
distribution). There are several methods to accomplish this; in this book, we
will use the <em>bootstrap</em>. We will discuss <strong>interval estimation</strong> and
construct
<strong>confidence intervals</strong> using just a single sample from a population. A
confidence interval is a range of plausible values for our population parameter.</p>
<p>Here is the key idea. First, if you take a big enough sample, it <em>looks like</em>
the population. Notice the histograms’ shapes for samples of different sizes
taken from the population in the figure below. We
see that the sample’s distribution looks like that of the population for a
large enough sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot sample distributions for n = 10, 20, 50, 100, 200</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>

<span class="c1"># Set up subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Distribution of Prices in Airbnb Samples&#39;</span><span class="p">)</span>

<span class="c1"># Plot population distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">airbnb</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">601</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Population Distribution&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price per night (dollars)&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="c1"># Plot sample distributions for different sample sizes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample_n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">):</span>
    <span class="n">sample</span> <span class="o">=</span> <span class="n">airbnb</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_n</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">601</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;n = </span><span class="si">{</span><span class="n">sample_n</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Price per night (dollars)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_47_0.png" src="../_images/inference_47_0.png" />
</div>
</div>
<p>In the previous section, we took many samples of the same size <em>from our
population</em> to get a sense of the variability of a sample estimate. But if our
sample is big enough that it looks like our population, we can pretend that our
sample <em>is</em> the population, and take more samples (with replacement) of the
same size from it instead! This very clever technique is
called <strong>the bootstrap</strong>.  Note that by taking many samples from our single, observed
sample, we do not obtain the true sampling distribution, but rather an
approximation that we call <strong>the bootstrap distribution</strong>.</p>
<div class="alert alert-info">
    <b>Note:</b>We must sample <i>with</i> replacement when using the bootstrap.
Otherwise, if we had a sample of size $n$, and obtained a sample from it of
    size $n$ <i>without</i> replacement, it would just return our original sample!
</div><p>This section will explore how to create a bootstrap distribution from a single
sample using Python.  The process is visualized in the flow chart below.
For a sample of size <span class="math notranslate nohighlight">\(n\)</span>, you would do the following:</p>
<ol class="simple">
<li><p>Randomly select an observation from the original sample (e.g., 9 Airbnb listings, 15 individuals post-stroke, 20 healthy young adults, etc.), which was drawn from the population (all Vancouver Airbnb listings, all Canadian adults post-stroke, all healthy, neurotypical adults between the ages of 18-35 across the globe, etc.).</p></li>
<li><p>Record the observation’s value.</p></li>
<li><p>Replace that observation.</p></li>
<li><p>Repeat steps 1–3 (sampling <em>with</em> replacement) until you have <span class="math notranslate nohighlight">\(n\)</span> observations, which form a bootstrap sample.</p></li>
<li><p>Calculate the bootstrap point estimate (e.g., mean, median, proportion, slope, etc.) of the <span class="math notranslate nohighlight">\(n\)</span> observations in your bootstrap sample.</p></li>
<li><p>Repeat steps 1–5 many times to create a distribution of point estimates (the bootstrap distribution).</p></li>
<li><p>Calculate the plausible range of values around our observed point estimate.</p></li>
</ol>
<p><img alt="" src="../_images/intro-bootstrap.jpeg" /></p>
</section>
<section id="bootstrapping-in-python">
<h3>Bootstrapping in Python<a class="headerlink" href="#bootstrapping-in-python" title="Permalink to this headline">#</a></h3>
<p>Let’s continue working with our Airbnb example to illustrate how we might create
and use a bootstrap distribution using just a single sample from the population.
Once again, suppose we are
interested in estimating the population mean price per night of all Airbnb
listings in Vancouver, Canada, using a single sample size of 40.
Recall our point estimate was \$153.48. The
histogram of prices in the sample is displayed in the figure below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>neighbourhood</th>
      <th>room_type</th>
      <th>accommodates</th>
      <th>bathrooms</th>
      <th>bedrooms</th>
      <th>beds</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4025</th>
      <td>4026</td>
      <td>Renfrew-Collingwood</td>
      <td>Private room</td>
      <td>1</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>1</td>
      <td>40.00</td>
    </tr>
    <tr>
      <th>1977</th>
      <td>1978</td>
      <td>Fairview</td>
      <td>Private room</td>
      <td>1</td>
      <td>2 baths</td>
      <td>3</td>
      <td>1</td>
      <td>70.00</td>
    </tr>
    <tr>
      <th>4008</th>
      <td>4009</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>269.00</td>
    </tr>
    <tr>
      <th>1543</th>
      <td>1544</td>
      <td>Kensington-Cedar Cottage</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>2 baths</td>
      <td>3</td>
      <td>5</td>
      <td>320.00</td>
    </tr>
    <tr>
      <th>3350</th>
      <td>3351</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>140.00</td>
    </tr>
    <tr>
      <th>804</th>
      <td>805</td>
      <td>Mount Pleasant</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>77.00</td>
    </tr>
    <tr>
      <th>2286</th>
      <td>2287</td>
      <td>Marpole</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>105.00</td>
    </tr>
    <tr>
      <th>1010</th>
      <td>1011</td>
      <td>Strathcona</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>120.00</td>
    </tr>
    <tr>
      <th>1878</th>
      <td>1879</td>
      <td>Fairview</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>175.00</td>
    </tr>
    <tr>
      <th>1644</th>
      <td>1645</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>2 baths</td>
      <td>2</td>
      <td>1</td>
      <td>150.00</td>
    </tr>
    <tr>
      <th>4579</th>
      <td>4580</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>160.00</td>
    </tr>
    <tr>
      <th>2771</th>
      <td>2772</td>
      <td>Dunbar Southlands</td>
      <td>Entire home/apt</td>
      <td>5</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>130.00</td>
    </tr>
    <tr>
      <th>4151</th>
      <td>4152</td>
      <td>Kitsilano</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>289.00</td>
    </tr>
    <tr>
      <th>4495</th>
      <td>4496</td>
      <td>Riley Park</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>115.00</td>
    </tr>
    <tr>
      <th>1308</th>
      <td>1309</td>
      <td>Riley Park</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>105.00</td>
    </tr>
    <tr>
      <th>2246</th>
      <td>2247</td>
      <td>Mount Pleasant</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>105.00</td>
    </tr>
    <tr>
      <th>2335</th>
      <td>2336</td>
      <td>Kensington-Cedar Cottage</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>85.00</td>
    </tr>
    <tr>
      <th>4059</th>
      <td>4060</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>5</td>
      <td>2 baths</td>
      <td>2</td>
      <td>3</td>
      <td>250.00</td>
    </tr>
    <tr>
      <th>1280</th>
      <td>1281</td>
      <td>Hastings-Sunrise</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>1 bath</td>
      <td>2</td>
      <td>3</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>4324</th>
      <td>4325</td>
      <td>Renfrew-Collingwood</td>
      <td>Private room</td>
      <td>1</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>0</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>3403</th>
      <td>3404</td>
      <td>Arbutus Ridge</td>
      <td>Entire home/apt</td>
      <td>15</td>
      <td>4 baths</td>
      <td>6</td>
      <td>8</td>
      <td>664.00</td>
    </tr>
    <tr>
      <th>1729</th>
      <td>1730</td>
      <td>Renfrew-Collingwood</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>1 bath</td>
      <td>2</td>
      <td>3</td>
      <td>93.00</td>
    </tr>
    <tr>
      <th>3722</th>
      <td>3723</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>3</td>
      <td>6</td>
      <td>275.00</td>
    </tr>
    <tr>
      <th>241</th>
      <td>242</td>
      <td>Hastings-Sunrise</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>1</td>
      <td>50.00</td>
    </tr>
    <tr>
      <th>3955</th>
      <td>3956</td>
      <td>Dunbar Southlands</td>
      <td>Private room</td>
      <td>2</td>
      <td>1.5 shared baths</td>
      <td>1</td>
      <td>1</td>
      <td>60.00</td>
    </tr>
    <tr>
      <th>1042</th>
      <td>1043</td>
      <td>Kitsilano</td>
      <td>Private room</td>
      <td>1</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>1</td>
      <td>66.00</td>
    </tr>
    <tr>
      <th>649</th>
      <td>650</td>
      <td>Sunset</td>
      <td>Entire home/apt</td>
      <td>5</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>196.00</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>1996</td>
      <td>Riley Park</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>1</td>
      <td>70.00</td>
    </tr>
    <tr>
      <th>363</th>
      <td>364</td>
      <td>Kensington-Cedar Cottage</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>120.00</td>
    </tr>
    <tr>
      <th>1783</th>
      <td>1784</td>
      <td>Downtown Eastside</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>60.00</td>
    </tr>
    <tr>
      <th>805</th>
      <td>806</td>
      <td>Mount Pleasant</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>150.00</td>
    </tr>
    <tr>
      <th>254</th>
      <td>255</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1.5 baths</td>
      <td>2</td>
      <td>2</td>
      <td>300.00</td>
    </tr>
    <tr>
      <th>3365</th>
      <td>3366</td>
      <td>Sunset</td>
      <td>Private room</td>
      <td>1</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>4562</th>
      <td>4563</td>
      <td>Downtown</td>
      <td>Private room</td>
      <td>1</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>1</td>
      <td>64.29</td>
    </tr>
    <tr>
      <th>2124</th>
      <td>2125</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>2</td>
      <td>3</td>
      <td>200.00</td>
    </tr>
    <tr>
      <th>18</th>
      <td>19</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>2 baths</td>
      <td>2</td>
      <td>2</td>
      <td>200.00</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1998</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>2 baths</td>
      <td>3</td>
      <td>3</td>
      <td>257.00</td>
    </tr>
    <tr>
      <th>4329</th>
      <td>4330</td>
      <td>West End</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>0</td>
      <td>92.00</td>
    </tr>
    <tr>
      <th>3408</th>
      <td>3409</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>2 baths</td>
      <td>2</td>
      <td>2</td>
      <td>189.00</td>
    </tr>
    <tr>
      <th>635</th>
      <td>636</td>
      <td>Grandview-Woodland</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>2 baths</td>
      <td>1</td>
      <td>2</td>
      <td>103.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">one_sample</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_53_0.png" src="../_images/inference_53_0.png" />
</div>
</div>
<p>The histogram for the sample is skewed, with a few observations out to the right. The
mean of the sample is \$154.51.
Remember, in practice, we usually only have this one sample from the population. So
this sample and estimate are the only data we can work with.</p>
<p>We now perform steps 1–5 listed above to generate a single bootstrap
sample in Python and calculate a point estimate from that bootstrap sample. We will
continue using the <code class="docutils literal notranslate"><span class="pre">sample</span></code> function of our dataframe,
Critically, note that we now
set <code class="docutils literal notranslate"><span class="pre">frac=1</span></code> (“fraction”) to indicate that we want to draw as many samples as there are rows in the dataframe
(we could also have set <code class="docutils literal notranslate"><span class="pre">n=40</span></code> but then we would need to manually keep track of how many rows there are).
Since we need to sample with replacement when bootstrapping,
we change the <code class="docutils literal notranslate"><span class="pre">replace</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boot1</span> <span class="o">=</span> <span class="n">one_sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">boot1</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">321</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Single bootstrap sample&quot;</span><span class="p">,</span> 
     <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_55_0.png" src="../_images/inference_55_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boot1</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>132.65
</pre></div>
</div>
</div>
</div>
<p>Notice that the histogram of our bootstrap sample
has a similar shape to the original sample histogram. Though the shapes of
the distributions are similar, they are not identical. You’ll also notice that
the original sample mean and the bootstrap sample mean differ. How might that
happen? Remember that we are sampling with replacement from the original
sample, so we don’t end up with the same sample values again. We are <em>pretending</em>
that our single sample is close to the population, and we are trying to
mimic drawing another sample from the population by drawing one from our original
sample.</p>
<p>Let’s now take 20,000 bootstrap samples from the original sample (<code class="docutils literal notranslate"><span class="pre">one_sample</span></code>)
and calculate the means for
each of those replicates. Recall that this assumes that <code class="docutils literal notranslate"><span class="pre">one_sample</span></code> <em>looks like</em>
our original population; but since we do not have access to the population itself,
this is often the best we can do.
Note that here we break the list comprehension over multiple lines
so that it is easier to read.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boot20000</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">one_sample</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">replicate</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20000</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">boot20000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>neighbourhood</th>
      <th>room_type</th>
      <th>accommodates</th>
      <th>bathrooms</th>
      <th>bedrooms</th>
      <th>beds</th>
      <th>price</th>
      <th>replicate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2286</th>
      <td>2287</td>
      <td>Marpole</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>2</td>
      <td>2</td>
      <td>105.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>254</th>
      <td>255</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1.5 baths</td>
      <td>2</td>
      <td>2</td>
      <td>300.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2246</th>
      <td>2247</td>
      <td>Mount Pleasant</td>
      <td>Entire home/apt</td>
      <td>4</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>105.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4579</th>
      <td>4580</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>3</td>
      <td>1 bath</td>
      <td>1</td>
      <td>2</td>
      <td>160.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4495</th>
      <td>4496</td>
      <td>Riley Park</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>115.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>1998</td>
      <td>Downtown</td>
      <td>Entire home/apt</td>
      <td>6</td>
      <td>2 baths</td>
      <td>3</td>
      <td>3</td>
      <td>257.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>241</th>
      <td>242</td>
      <td>Hastings-Sunrise</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 shared bath</td>
      <td>1</td>
      <td>1</td>
      <td>50.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>1878</th>
      <td>1879</td>
      <td>Fairview</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>175.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>1783</th>
      <td>1784</td>
      <td>Downtown Eastside</td>
      <td>Private room</td>
      <td>2</td>
      <td>1 private bath</td>
      <td>1</td>
      <td>1</td>
      <td>60.0</td>
      <td>19999</td>
    </tr>
    <tr>
      <th>4495</th>
      <td>4496</td>
      <td>Riley Park</td>
      <td>Entire home/apt</td>
      <td>2</td>
      <td>1 bath</td>
      <td>1</td>
      <td>1</td>
      <td>115.0</td>
      <td>19999</td>
    </tr>
  </tbody>
</table>
<p>800000 rows × 9 columns</p>
</div></div></div>
</div>
<p>Let’s take a look at histograms of the first six replicates of our bootstrap samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">six_bootstrap_samples</span> <span class="o">=</span> <span class="n">boot20000</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;replicate &lt; 6&quot;</span><span class="p">)</span>

<span class="c1"># Create a seaborn FacetGrid object (allows for subplots)</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">six_bootstrap_samples</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;replicate&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Plot histograms for each replicate</span>
<span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">701</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

<span class="c1"># Set axis labels and title</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s2">&quot;Price per night (dollars)&quot;</span><span class="p">,</span> <span class="s2">&quot;Count&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_titles</span><span class="p">(</span><span class="n">col_template</span><span class="o">=</span><span class="s2">&quot;Replicate </span><span class="si">{col_name}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Label figure</span>
<span class="n">g</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Histograms of first six replicates of bootstrap samples&quot;</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_60_0.png" src="../_images/inference_60_0.png" />
</div>
</div>
<p>We can see how the distributions of the
bootstrap samples differ. If we calculate the sample mean for each of
these six samples, we can see that these are also different between samples.
To compute the mean for each sample,
we first group by the “replicate” which is the column containing the sample/replicate number.
Then we compute the mean of the <code class="docutils literal notranslate"><span class="pre">price</span></code> column and rename it to <code class="docutils literal notranslate"><span class="pre">mean_price</span></code>
for it to be more descriptive.
Finally we use <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> to get the <code class="docutils literal notranslate"><span class="pre">replicate</span></code> values back as a column in the dataframe. (Note that for readability, you can enclose your Python expression in parentheses so that you can break up your expression across multiple lines.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">six_bootstrap_samples</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;replicate&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_price&quot;</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>replicate</th>
      <th>mean_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>155.67175</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>154.42500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>149.35000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>169.13225</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>179.79675</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>188.28225</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The distributions and the means differ between the bootstrapped samples
because we are sampling <em>with replacement</em>.
If we instead would have sampled <em>without replacement</em>,
we would end up with the exact same values in the sample each time.</p>
<p>We will now calculate point estimates of the mean for our 20,000 bootstrap samples and
generate a bootstrap distribution of these point estimates. The bootstrap
distribution (figure below) suggests how we might expect
our point estimate to behave if we take multiple samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boot20000_means</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">boot20000</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;replicate&quot;</span><span class="p">)</span>
    <span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_price&quot;</span><span class="p">})</span>
<span class="p">)</span>

<span class="n">boot20000_means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>replicate</th>
      <th>mean_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>155.67175</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>154.42500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>149.35000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>169.13225</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>179.79675</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19995</th>
      <td>19995</td>
      <td>159.29675</td>
    </tr>
    <tr>
      <th>19996</th>
      <td>19996</td>
      <td>137.20000</td>
    </tr>
    <tr>
      <th>19997</th>
      <td>19997</td>
      <td>136.55725</td>
    </tr>
    <tr>
      <th>19998</th>
      <td>19998</td>
      <td>161.93950</td>
    </tr>
    <tr>
      <th>19999</th>
      <td>19999</td>
      <td>170.22500</td>
    </tr>
  </tbody>
</table>
<p>20000 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">boot20000_means</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;mean_price&quot;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distribution of bootstrap sample means&quot;</span><span class="p">,</span>
     <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Sample mean price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_65_0.png" src="../_images/inference_65_0.png" />
</div>
</div>
<p>Let’s compare the bootstrap distribution—which we construct by taking many samples from our original sample of size 40—with
the true sampling distribution—which corresponds to taking many samples from the population.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot sampling distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">sample_estimates</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f77b4&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sample mean price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_estimates</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f58518&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_estimates</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">1250</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mean = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample_estimates</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f58518&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Plot bootstrap distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">boot20000_means</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#1f77b4&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sample mean price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">boot20000_means</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f58518&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">boot20000_means</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">y</span><span class="o">=</span><span class="mi">1250</span><span class="p">,</span>
    <span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Mean = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">boot20000_means</span><span class="p">[</span><span class="s1">&#39;mean_price&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#f58518&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
    <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Titles</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Sampling Distribution&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Bootstrap Distribution&quot;</span><span class="p">)</span>

<span class="c1"># Adjust layout and show figures</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_67_0.png" src="../_images/inference_67_0.png" />
</div>
</div>
<p>There are two essential points that we can take away from
the above histograms. First, the shape and spread of the true sampling
distribution and the bootstrap distribution are similar; the bootstrap
distribution lets us get a sense of the point estimate’s variability. The
second important point is that the means of these two distributions are
slightly different. The sampling distribution is centered at
\<span class="math notranslate nohighlight">\(154.51, the population mean value. However, the bootstrap
distribution is centered at the original sample's mean price per night,
\\\)</span>153.48. Because we are resampling from the
original sample repeatedly, we see that the bootstrap distribution is centered
at the original sample’s mean value (unlike the sampling distribution of the
sample mean, which is centered at the population parameter value).</p>
<div class="alert alert-info"> <b>Take a minute to appreciate what the bootstrapping technique has allowed us to accomplish.</b> With a single sample of 40 observations (from a much, much larger population), we've <i>very</i> closely approximated the true sampling distribution, which by definition uses the entire population of observations to compute, something we almost never have access to in real world data science applications. In essence, bootstrapping is a means of simulating many data collections (or experiments), premised only on the assumption that our single sample is representative of the population.</d><p>The flow chart below summarizes the bootstrapping process.
The idea here is that we can use this distribution of bootstrap sample means to
approximate the sampling distribution of the sample means when we only have one
sample. Since the bootstrap distribution pretty well approximates the sampling
distribution spread, we can use the bootstrap spread to help us develop a
plausible range for our population parameter along with our estimate!</p>
<p><img alt="" src="https://datasciencebook.ca/_main_files/figure-html/11-bootstrapping7-1.png" /></p>
</section>
<section id="using-the-bootstrap-to-calculate-a-plausible-range">
<h3>Using the bootstrap to calculate a plausible range<a class="headerlink" href="#using-the-bootstrap-to-calculate-a-plausible-range" title="Permalink to this headline">#</a></h3>
<p>Now that we have constructed our bootstrap distribution, let’s use it to create
an approximate 95% percentile bootstrap confidence interval (one of the most common applications of bootstrapping).
A <strong>confidence interval</strong> is a range of plausible values for the population parameter. We will
find the range of values covering the middle 95% of the bootstrap
distribution, giving us a 95% confidence interval.  You may be wondering, what
does “95% confidence” mean? If we took 100 random samples and calculated 100
95% confidence intervals, then about 95% of the ranges would capture the
population parameter’s value.  Note there’s nothing special about 95%. We
could have used other levels, such as 90% or 99%. There is a balance between
our level of confidence and precision. A higher confidence level corresponds to
a wider range of the interval, and a lower confidence level corresponds to a
narrower range. Therefore the level we choose is based on what chance we are
willing to take of being wrong based on the implications of being wrong for our
application. In general, we choose confidence levels to be comfortable with our
level of uncertainty but not so strict that the interval is unhelpful. For
instance, if our decision impacts human life and the implications of being
wrong are deadly, we may want to be very confident and choose a higher
confidence level.</p>
<p>To calculate a 95% percentile bootstrap confidence interval, we will do the following:</p>
<ol class="simple">
<li><p>Arrange the observations in the bootstrap distribution in ascending order.</p></li>
<li><p>Find the value such that 2.5% of observations fall below it (the 2.5% percentile). Use that value as the lower bound of the interval.</p></li>
<li><p>Find the value such that 97.5% of observations fall below it (the 97.5% percentile). Use that value as the upper bound of the interval.</p></li>
</ol>
<p>To do this in Python, we wiill again use the <code class="docutils literal notranslate"><span class="pre">quantile</span></code> function of our DataFrame.
Quantiles are expressed in proportions rather than percentages,
so the 2.5th and 97.5th percentiles
would be quantiles 0.025 and 0.975, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci_bounds</span> <span class="o">=</span> <span class="n">boot20000_means</span><span class="p">[</span><span class="s2">&quot;mean_price&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">])</span>
<span class="n">ci_bounds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.025    121.607069
0.975    191.525362
Name: mean_price, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Our interval, \<span class="math notranslate nohighlight">\(121.6 to \\\)</span>191.5, captures
the middle 95% of the sample mean prices in the bootstrap distribution. We can
visualize the interval on our distribution in the following figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">boot20000_means</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;mean_price&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">850</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sample mean price per night (dollars)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">ci_bounds</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:orange&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Distribution of bootstrap sample means with 95% CI&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/inference_74_0.png" src="../_images/inference_74_0.png" />
</div>
</div>
<p>To finish our estimation of the population parameter, we would report the point
estimate and our confidence interval’s lower and upper bounds. Here the sample
mean price-per-night of 40 Airbnb listings was
\<span class="math notranslate nohighlight">\(153.48, and we are 95% &quot;confident&quot; that the true
population mean price-per-night for all Airbnb listings in Vancouver is between
\\\)</span>(121.6, 191.5).
Notice that our interval does indeed contain the true
population mean value, \$154.51! However, in
practice, we would not know whether our interval captured the population
parameter or not because we usually only have a single sample, not the entire
population. This is the best we can do when we only have one sample!</p>
<p>This chapter is only the beginning of the journey into statistical inference.
We can extend the concepts learned here to do much more than report point
estimates and confidence intervals, such as testing for real differences
between populations, tests for associations between variables, and so much
more. We have just scratched the surface of statistical inference; however, the
material presented here will serve as a solid foundation for more advanced
statistical techniques you may learn about in the future!</p>
</section>
</section>
<section id="additional-resources">
<h2>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Chapters 4 to 7 of <a class="reference external" href="https://www.openintro.org/book/os/">OpenIntro Statistics</a>
provide a good next step in learning about inference. Although it is still certainly
an introductory text, things get a bit more mathematical here. Depending on
your background, you may actually want to start going through Chapters 1 to 3
first, where you will learn some fundamental concepts in probability theory.
Although it may seem like a diversion, probability theory is <em>the language of
statistics</em>; if you have a solid grasp of probability, more advanced statistics
will come naturally to you!</p></li>
<li><p>The first two chapters of <a class="reference external" href="https://www.hms.harvard.edu/bss/neuro/bornlab/nb204/statistics/bootstrap.pdf">An Introduction to the Bootstrap</a> are a great resource for bolstering your understanding of bootstrapping.</p></li>
</ul>
<hr class="docutils" />
<p>This chapter has been adapted from the excellent online textbook <a class="reference external" href="https://python.datasciencebook.ca/inference.html">Data Science: A First Introduction (Python Edition)</a> used in UBC’s Python-flavored DSCI 100 course.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6-Inference"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../5-eda/ttests.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Basic Statistics in Python: <em>t</em> tests with SciPy</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7-single_unit/introduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to Single Unit Data</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hyosub Kim<br/>
  
      &copy; Copyright 2023. This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License..<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>